<!DOCTYPE html>
<html lang="en" class="no-js">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://woumn.wordpress.com/xmlrpc.php">

<script>(function(html){html.className = html.className.replace(/\bno-js\b/,'js')})(document.documentElement);</script>
<title>Bypassing ASLR on Windows into a Reverse Shell &#8211; woumn</title>
<link rel='dns-prefetch' href='//s2.wp.com' />
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//s1.wp.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel="alternate" type="application/rss+xml" title="woumn &raquo; Feed" href="https://woumn.wordpress.com/feed/" />
<link rel="alternate" type="application/rss+xml" title="woumn &raquo; Comments Feed" href="https://woumn.wordpress.com/comments/feed/" />
	<script type="text/javascript">
		/* <![CDATA[ */
		function addLoadEvent(func) {
			var oldonload = window.onload;
			if (typeof window.onload != 'function') {
				window.onload = func;
			} else {
				window.onload = function () {
					oldonload();
					func();
				}
			}
		}
		/* ]]> */
	</script>
			<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/72x72\/","ext":".png","svgUrl":"https:\/\/s0.wp.com\/wp-content\/mu-plugins\/wpcom-smileys\/twemoji\/2\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/s1.wp.com\/wp-includes\/js\/wp-emoji-release.min.js?m=1473172720h&ver=4.6.1-RC1-38499"}};
			!function(a,b,c){function d(a){var c,d,e,f,g,h=b.createElement("canvas"),i=h.getContext&&h.getContext("2d"),j=String.fromCharCode;if(!i||!i.fillText)return!1;switch(i.textBaseline="top",i.font="600 32px Arial",a){case"flag":return i.fillText(j(55356,56806,55356,56826),0,0),!(h.toDataURL().length<3e3)&&(i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,65039,8205,55356,57096),0,0),c=h.toDataURL(),i.clearRect(0,0,h.width,h.height),i.fillText(j(55356,57331,55356,57096),0,0),d=h.toDataURL(),c!==d);case"diversity":return i.fillText(j(55356,57221),0,0),e=i.getImageData(16,16,1,1).data,f=e[0]+","+e[1]+","+e[2]+","+e[3],i.fillText(j(55356,57221,55356,57343),0,0),e=i.getImageData(16,16,1,1).data,g=e[0]+","+e[1]+","+e[2]+","+e[3],f!==g;case"simple":return i.fillText(j(55357,56835),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode8":return i.fillText(j(55356,57135),0,0),0!==i.getImageData(16,16,1,1).data[0];case"unicode9":return i.fillText(j(55358,56631),0,0),0!==i.getImageData(16,16,1,1).data[0]}return!1}function e(a){var c=b.createElement("script");c.src=a,c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var f,g,h,i;for(i=Array("simple","flag","unicode8","diversity","unicode9"),c.supports={everything:!0,everythingExceptFlag:!0},h=0;h<i.length;h++)c.supports[i[h]]=d(i[h]),c.supports.everything=c.supports.everything&&c.supports[i[h]],"flag"!==i[h]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[i[h]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(g=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",g,!1),a.addEventListener("load",g,!1)):(a.attachEvent("onload",g),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),f=c.source||{},f.concatemoji?e(f.concatemoji):f.wpemoji&&f.twemoji&&(e(f.twemoji),e(f.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='all-css-0' href='https://s0.wp.com/_static/??-eJx9j9sOgjAMhl/I2aho5ML4LNtoYLBuCx0hvr2dRI2HcNP08H9tf5iTsjFkDBloUslPrQsMc7KRFJPzePuqtpZ5A/8x7wZk6DEnbQf1qH7kxsf2fSeOjW4YWh+N9murbRxR+pR0LgrCxmn0SCJbwyidnlRJO/lr1cFi1Zg0IrOSSG4ilTs5tMoJVV5ZPIMIPzsL6iDE7ITmV1IGV7rsqmO9r3b14dzfAf/vlnw=' type='text/css' media='all' />
<link rel='stylesheet' id='independent-publisher-fonts-css'  href='https://fonts.googleapis.com/css?family=PT+Sans%3A400%2C700%2C400italic%2C700italic%7CPT+Serif%3A400%2C700%2C400italic%2C700italic&#038;subset=latin%2Clatin-ext' type='text/css' media='all' />
<link rel='stylesheet' id='all-css-2' href='https://s1.wp.com/_static/??-eJyVjtEKwjAMRX/Img4G4oP4LVuNXSRNStMx9vdWfNkQBV/CPdycEFiyCyoVpUKaXeY5khhEFCzUii/xGMwOsHHrhAkN8jwCyQ0ztiHVNWayCQtYXRn/10jCW3VLDpo+Dux+VscahkoqO3B3Hqj8UguOrLHFCG1rgy/pmi5df/L+3PneP57vX3LO' type='text/css' media='all' />
<style id='independent-publisher-style-inline-css' type='text/css'>
#hero-header { background: url("https://woumn.files.wordpress.com/2016/03/cropped-cropped-acgasdg.jpg") no-repeat center; background-size: cover; background-attachment: scroll; }
</style>
<link rel='stylesheet' id='print-css-3' href='https://s0.wp.com/wp-content/mu-plugins/global-print/global-print.css?m=1465851035h' type='text/css' media='print' />
<link rel='stylesheet' id='all-css-4' href='https://s0.wp.com/_static/??-eJx9i0EKAjEMRS9kDUJHx4V4lkypbSRNSpNhri8uRERx9d+H92DrIal4Foe2hs5rITHA5KSy4HjTPpnt4Lfe1TzcGGmAVRwk5bX/KtNEyIG16Of5irzmlg1qhMK6ID+Fa7sc4mma4nk+zvcHxaRJxQ==' type='text/css' media='all' />
<script type='text/javascript' src='https://s0.wp.com/_static/??-eJyFzt0KwjAMBeAXsiv+Tb0Qn6WrcaQuaW1Shz69HeiFMBQCgZyPQ+yYDLIfyhnEhjq3AvnxXk2Qhf0FDGGfnUJDyB/sIyuwTpZihwOYIpBdX2+16BJnXIqiBCIVzaTfLyHfEca/LIAm568mg+Bzaj3Rcblp2+1qfdjtwws0V1vd'></script>
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://woumn.wordpress.com/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://s1.wp.com/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Exploring the Human Interaction with Science as a Primary Nova in The Sentinel by Arthur C.&nbsp;Clark' href='https://woumn.wordpress.com/2016/10/05/exploring-the-human-interaction-with-science-as-a-primary-nova-in-the-sentinel-by-arthur-c-clark/' />
<meta name="generator" content="WordPress.com" />
<link rel="canonical" href="https://woumn.wordpress.com/2016/10/12/bypassing-aslr-on-windows-into-a-reverse-shell/" />
<link rel='shortlink' href='http://wp.me/p7mMyL-hj' />
<link rel="alternate" type="application/json+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=json&amp;url=https%3A%2F%2Fwoumn.wordpress.com%2F2016%2F10%2F12%2Fbypassing-aslr-on-windows-into-a-reverse-shell%2F&amp;for=wpcom-auto-discovery" /><link rel="alternate" type="application/xml+oembed" href="https://public-api.wordpress.com/oembed/1.0/?format=xml&amp;url=https%3A%2F%2Fwoumn.wordpress.com%2F2016%2F10%2F12%2Fbypassing-aslr-on-windows-into-a-reverse-shell%2F&amp;for=wpcom-auto-discovery" />
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="Bypassing ASLR on Windows into a Reverse Shell" />
<meta property="og:url" content="https://woumn.wordpress.com/2016/10/12/bypassing-aslr-on-windows-into-a-reverse-shell/" />
<meta property="og:description" content="House Keeping I referenced some of my previous exploit&#8217;s work throughout this post, so I&#8217;d suggest you check it out. I&#8217;m also going to mainly focus on the new stack environment we…" />
<meta property="article:published_time" content="2016-10-12T15:01:12+00:00" />
<meta property="article:modified_time" content="2016-10-12T22:43:11+00:00" />
<meta property="og:site_name" content="woumn" />
<meta property="og:image" content="https://woumn.files.wordpress.com/2016/10/goal_stack1.png" />
<meta property="og:image:width" content="852" />
<meta property="og:image:height" content="273" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:site" content="@wordpressdotcom" />
<meta name="twitter:image" content="https://woumn.files.wordpress.com/2016/10/original_stack.png?w=240" />
<meta name="twitter:card" content="summary" />
<meta property="fb:app_id" content="249643311490" />
<meta property="article:publisher" content="https://www.facebook.com/WordPresscom" />
<link rel="shortcut icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/34fad3d3da3acb910577795456af6862?s=32" sizes="16x16" />
<link rel="icon" type="image/x-icon" href="https://secure.gravatar.com/blavatar/34fad3d3da3acb910577795456af6862?s=32" sizes="16x16" />
<link rel="apple-touch-icon-precomposed" href="https://secure.gravatar.com/blavatar/34fad3d3da3acb910577795456af6862?s=114" />
<link rel="search" type="application/opensearchdescription+xml" href="https://woumn.wordpress.com/osd.xml" title="woumn" />
<link rel="search" type="application/opensearchdescription+xml" href="https://s1.wp.com/opensearch.xml" title="WordPress.com" />
<meta name="theme-color" content="#435464" />
		<style type="text/css">
			.recentcomments a {
				display: inline !important;
				padding: 0 !important;
				margin: 0 !important;
			}

			table.recentcommentsavatartop img.avatar, table.recentcommentsavatarend img.avatar {
				border: 0px;
				margin: 0;
			}

			table.recentcommentsavatartop a, table.recentcommentsavatarend a {
				border: 0px !important;
				background-color: transparent !important;
			}

			td.recentcommentsavatarend, td.recentcommentsavatartop {
				padding: 0px 0px 1px 0px;
				margin: 0px;
			}

			td.recentcommentstextend {
				border: none !important;
				padding: 0px 0px 2px 10px;
			}

			.rtl td.recentcommentstextend {
				padding: 0px 10px 2px 0px;
			}

			td.recentcommentstexttop {
				border: none;
				padding: 0px 0px 0px 10px;
			}

			.rtl td.recentcommentstexttop {
				padding: 0px 10px 0px 0px;
			}
		</style>
		<meta name="application-name" content="woumn" /><meta name="msapplication-window" content="width=device-width;height=device-height" /><meta name="msapplication-tooltip" content="-n. self-defined: the ramblings of a security-minded computer science student." /><meta name="msapplication-task" content="name=Subscribe;action-uri=https://woumn.wordpress.com/feed/;icon-uri=https://secure.gravatar.com/blavatar/34fad3d3da3acb910577795456af6862?s=16" /><meta name="msapplication-task" content="name=Sign up for a free blog;action-uri=http://wordpress.com/signup/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Support;action-uri=http://support.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="msapplication-task" content="name=WordPress.com Forums;action-uri=http://forums.wordpress.com/;icon-uri=https://s2.wp.com/i/favicon.ico" /><meta name="title" content="Bypassing ASLR on Windows into a Reverse&nbsp;Shell | woumn on WordPress.com" />
<meta name="description" content="House Keeping I referenced some of my previous exploit&#039;s work throughout this post, so I&#039;d suggest you check it out. I&#039;m also going to mainly focus on the new stack environment we have here, and how to structure a payload to bypass ASLR. This is slightly different than my previous post, and the change is&hellip;" />
<style type="text/css" id="custom-background-css">
body.custom-background { background-color: #435464; }
</style>
		<script type="text/javascript" src="http://c.amazon-adsystem.com/aax2/amzn_ads.js"></script>
		<script type="text/javascript">
		try { amznads.getAds("3033"); } catch(e) { /* ignore */ }
		</script>
		<script type="text/javascript">
		try {
			var a9_p = amznads.getKeys(),
			_ipw_custom = {
				wordAds: '0',
				adSafe: '0',
				domain: 'woumn.wordpress.com',
				pageURL: 'https://woumn.wordpress.com/2016/10/12/bypassing-aslr-on-windows-into-a-reverse-shell/'
			};
			if("undefined"!=typeof a9_p&&""!=a9_p&&null!==a9_p&&"[object Array]"===Object.prototype.toString.call(a9_p)){var a="",b=0,c=a9_p.length;a9_p.sort();for(var d=0;d<c;d++){a9_p[d-b]=a9_p[d-b].replace(/a1x6p/,"a160x600p");var e=a9_p[d-b].split("p");e[0]==a&&(a9_p.splice(d-b,1),b++);a=e[0]}_ipw_custom.amznPay=a9_p};document.close();
		} catch(e) {}
		</script>		<!-- Criteo AdBlock Plus script-->
		<script type="text/javascript" src="https://static.criteo.net/js/ld/publishertag.js"></script>
		<!-- IPONWEB header script -->
		<script type="text/javascript">
			window.__ATA = {
				scriptSrc: '//s.pubmine.com/showad.js',
				slotPrefix: 'automattic-id-',
				initAd: function(o) {
					var o = o || {},
						g = window,
						d = g.document,
						wr = d.write,
						id = g.__ATA.id();
					wr.call(d, '<div id="' + id + '" data-section="' + (o.sectionId || 0) + '"' + (o.type ? ('data-type="' + o.type + '"') : '') + ' ' + (o.forcedUrl ? ('data-forcedurl="' + o.forcedUrl + '"') : '') + ' style="width:' + (o.width || 0) + 'px; height:' + (o.height || 0) + 'px;">');
					g.__ATA.displayAd(id);
					wr.call(d, '</div>');
					g.__ATA.displayAdBlockedAd( id, o );
				},
				displayAd: function(id) {
					window.__ATA.ids = window.__ATA.ids || {};
					window.__ATA.ids[id] = 1;
				},
				customParams: _ipw_custom,
				id: function() {
					return window.__ATA.slotPrefix + (parseInt(Math.random() * 10000, 10) + 1 + (new Date()).getMilliseconds());
				},
				displayAdBlockedAd: function( id, t ) {
					if ( true !== true ) {
						return;
					}

					if ( typeof Criteo !== 'object' ) {
						return;
					}

					if ( 300 === parseInt( t.width ) && 250 === parseInt( t.height ) ) {
						var wpa = document.getElementsByClassName( 'wpa' );
						for( var i = 0; i < wpa.length; i++ ) {
							wpa[i].style.setProperty( 'visibility', 'visible', 'important' );
							wpa[i].style.setProperty( 'display', 'inline-block', 'important' );
						}

						Criteo.DisplayAcceptableAdIfAdblocked( {
							zoneid: 388248,
							containerid: id,
							collapsecontainerifnotadblocked: false
						});
					}
				}
			};
			(function(d, ata) {
				var pr = "https:" === d.location.protocol ? "https:" : "http:",
					src = pr + ata.scriptSrc,
					st = "text/javascript";
				d.write('<scr' + 'ipt type="' + st + '" src="' + src + '"><\/scr' + 'ipt>');
			})(window.document, window.__ATA);
		</script>
		<script type="text/javascript">
		jQuery(window).ready(function () {
			jQuery("a.wpa-about").text("About these ads");
		});
		</script><link rel="amphtml" href="https://woumn.wordpress.com/2016/10/12/bypassing-aslr-on-windows-into-a-reverse-shell/amp/" /><style type="text/css" id="syntaxhighlighteranchor"></style>
<style type="text/css" id="custom-colors-css">.site-header .social-navigation li a,.widget_wpcom_social_media_icons_widget li a{opacity:.6}.site-header .social-navigation li a:hover,.widget_wpcom_social_media_icons_widget li a:hover{opacity:1}.site-header .menu-toggle{opacity:.9}.site-header .menu-toggle:hover,.site-header .menu-toggle:focus,.site-header .menu-toggle:active{opacity:1}.post-details time{color:inherit}.bypostauthor{box-shadow:none}#page .site-title a{color:white}.comment-reply-title,#cancel-comment-reply-link,#commentform label,#commentform .logged-in-as{text-shadow:none}body:not(.highlander-enabled) #respond{background:rgba(255,255,255,0.03)}#page .entry-title a:not(:hover),.entry-meta.light-text span.cat-links a{color:inherit}#slide-menu,#slide-menu .social-navigation ul li a{text-shadow:none}#slide-menu .menu-title{opacity:.6}.post-edit-link a{text-shadow:none}button:not(.menu-toggle),input[type="button"],input[type="reset"],input[type="submit"],.posts-navigation .nav-links a,#content #infinite-handle span button{text-shadow:none}#page #post-cover-image .cover-meta .entry-meta a:hover{color:rgba(255,255,255,0.88)}.post-details a:not(:hover){color:inherit}code,kbd,tt,var{background:rgba(0,0,0,0.15)}body{background-color:#435464}#page .site-title{color:#fff}input[type="text"],input[type="password"],input[type="email"],input[type="search"],input[type="url"],textarea{border-color:#c8d0d9}.sticky-label{color:#435464}.sticky-label{background-color:#fff}.site-header .site-description{color:#c8d0d9}.widget .widget-title,.widget .widgettitle{color:#fff}#slide-menu{background-color:#fff}#slide-menu .menu-title{color:#6c849d}#slide-menu .social-navigation ul li a{color:#6c849d}#slide-menu .social-navigation ul li a:hover{color:#435464}.main-slide-navigation>ul li a{color:#435464}.page-header:not(.page-header-light){background-color:#dee5e7}.page-header:not(.page-header-light) h1{color:#435464}input,textarea{color:#768383}.post-edit-link a{background:#939e9e}.post-edit-link a:hover{background:#869191}#main>article.hentry:nth-child(n+2),#page .infinite-wrap>article.hentry:nth-child(n+2),.infinite-wrap{border-color:#7f8b8b}.posts-navigation,body:not(.single) .site-footer .widget-area{border-top-color:#7f8b8b}body,button,select,.widget_recent_comments a,.widget_recent_entries a{color:#fff}h1,h2,h3,h4,h5,h6,.site-title,.site-posted-on strong,.entry-title,.post-author-card .author.vcard{color:#fff}button:not(.menu-toggle):focus,input[type="button"]:focus,input[type="reset"]:focus,input[type="submit"]:focus,.posts-navigation .nav-links a:focus,#content #infinite-handle span button:focus,button:not(.menu-toggle):active,input[type="button"]:active,input[type="reset"]:active,input[type="submit"]:active,.posts-navigation .nav-links a:active,#content #infinite-handle span button:active,.rtl button:not(.menu-toggle):focus,.rtl input[type="button"]:focus,.rtl input[type="reset"]:focus,.rtl input[type="submit"]:focus,.rtl .posts-navigation .nav-links a:focus,.rtl #content #infinite-handle span button:focus,.rtl button:not(.menu-toggle):active,.rtl input[type="button"]:active,.rtl input[type="reset"]:active,.rtl input[type="submit"]:active,.rtl .posts-navigation .nav-links a:active,.rtl #content #infinite-handle span button:active,button:not(.menu-toggle):hover,input[type="button"]:hover,input[type="reset"]:hover,input[type="submit"]:hover,.posts-navigation .nav-links a:hover,#content #infinite-handle span button:hover{background-color:#9ba5a5}.site-header .menu-toggle,.site-header .menu-toggle:hover,.site-header .menu-toggle:active{color:#fff}.site-header .menu-toggle,.site-header .menu-toggle:hover,.site-header .menu-toggle:active{border-color:#fff}body:not(.tablet-desktop) #primary-menu>li a{border-top-color:#798585}body:not(.tablet-desktop) #site-navigation{border-bottom-color:#798585}body:not(.tablet-desktop) #primary-menu{border-color:#798585}body:not(.tablet-desktop) #primary-menu>li.current-menu-item a,body:not(.tablet-desktop) #primary-menu>li.current_page_item a{background-color:#fff}.main-slide-navigation>ul li a:hover,.main-slide-navigation>ul li a:focus,.main-slide-navigation>ul li a:active,.main-slide-navigation>ul li.current-menu-item>a,.main-slide-navigation>ul li.current_page_item>a{color:#545d5d}.entry-title{color:#fff}.site-info{color:#b4bbbb}hr{background-color:#798585}pre{color:#4d5555}.light-text{color:#9ba5a5}#cancel-comment-reply-link{color:#ccd0d0}#respond{border-color:#798585}.comment{border-color:#798585}.comment .comment-meta .comment-author .fn{color:#fff}.comment .comment-meta{color:#9ba5a5}.wp-caption-text,.wp-caption-dd{color:#b4bbbb}.post-details,.post-details a{color:#b4bbbb}.post-details span:not(:last-child):after,.post-details span.author.vcard+span.post-permalink:before{color:#798585}blockquote,.format-status .entry-content,.format-status .entry-summary{color:#fff}.post-author-card{border-color:#ccd0d0}.post-navigation{border-bottom-color:#ccd0d0}div#jp-relatedposts h3.jp-relatedposts-headline em:before{border-top-color:#ccd0d0}.post-edit-link a,#page .post-edit-link a:hover{color:#fff}#primary-menu>li a{color:#fff}.wp-caption-text strong,.wp-caption-dd strong{color:#fff}.main-slide-navigation>ul li a:hover{background-color:#798585}.main-slide-navigation>ul li a:hover{background-color:rgba(121,133,133,.08)}.post-navigation .nav-links a{color:#9ba5a5}.post-tags li:first-child{color:#ccd0d0}.widget_recent_entries{color:#ccd0d0}.post-author-card .author-description,.site-posted-on time{color:#ccd0d0}#primary-menu>li.menu-item-has-children>a:after{color:#bcde72}a,a:visited,a:hover,a:focus,a:active{color:#bcde72}#primary-menu>li.current-menu-item>a,#primary-menu>li a:hover,#primary-menu>li a:focus,#primary-menu>li a:active,.no-js .main-slide-navigation>ul li a:hover,.no-js .main-slide-navigation>ul li a:focus,.no-js .main-slide-navigation>ul li a:active,.no-js .main-slide-navigation>ul li.current-menu-item>a,.pingback:before,.trackback:before,.comment .comment-meta .comment-metadata a:hover,#commentform span.required,.entry-title a:hover,.site-footer a:hover,.post-details a:hover,.post-edit-link a:focus,.post-edit-link a:active,#page .entry-meta.light-text a:hover,.post-navigation .nav-links a:hover,.post-navigation .nav-links a:focus,.post-navigation .nav-links a:active{color:#bcde72}input[type="text"]:focus,input[type="password"]:focus,input[type="email"]:focus,input[type="search"]:focus,input[type="url"]:focus,textarea:focus,#commentform input[type="text"]:focus,#commentform input[type="password"]:focus,#commentform input[type="email"]:focus,#commentform input[type="search"]:focus,#commentform input[type="url"]:focus,#commentform textarea:focus,#commentform input[type="text"]:active,#commentform input[type="password"]:active,#commentform input[type="email"]:active,#commentform input[type="search"]:active,#commentform input[type="url"]:active,#commentform textarea:active{border-color:#bcde72}button:not(.menu-toggle),input[type="button"],input[type="reset"],input[type="submit"],.posts-navigation .nav-links a,#content #infinite-handle span button{background-color:#bcde72}.format-quote .entry-content blockquote,.format-quote .entry-summary blockquote{border-left-color:#bcde72}.comment .comment-reply-link:hover{color:#fff}.bypostauthor{border-color:#bcde72}.post-edit-link a:hover{color:#bcde72}.tablet-desktop #primary-menu>li.menu-item-has-children>ul.sub-menu{border-left-color:#bcde72}.page-links a:hover{color:#fff}blockquote{border-left-color:#d5eaa8}.light-text a:hover{color:#d5eaa8}.page-header:not(.page-header-light){border-left-color:#bcde72}button:not(.menu-toggle),input[type="button"],input[type="reset"],input[type="submit"],.posts-navigation .nav-links a,#content #infinite-handle span button{color:#435b0f}.tablet-desktop #primary-menu>li ul.sub-menu li.current-menu-item>a,.tablet-desktop #primary-menu>li ul.sub-menu li.current_page_item>a{color:#587717}.tablet-desktop #primary-menu>li ul.sub-menu li a:hover,.tablet-desktop #primary-menu>li ul.sub-menu li a:focus,.tablet-desktop #primary-menu>li ul.sub-menu li a:active,.tablet-desktop #primary-menu>li ul.sub-menu li:hover>a,.tablet-desktop #primary-menu>li ul.sub-menu li.current-menu-item>a{color:#587717}body:not(.tablet-desktop) #primary-menu>li.current-menu-item>a,body:not(.tablet-desktop) #primary-menu>li.current_page_item>a,body:not(.tablet-desktop) #primary-menu>li a:hover,body:not(.tablet-desktop) #primary-menu>li a:focus,body:not(.tablet-desktop) #primary-menu>li a:active{color:#65871b}.page-links>span{color:#567316}.site-header .social-navigation li a,.widget_wpcom_social_media_icons_widget li a{color:#d5e3fa}.site-header .social-navigation li a:hover,.widget_wpcom_social_media_icons_widget li a:hover{color:#d5e3fa}</style>
<script type="text/javascript">
	window.google_analytics_uacct = "UA-52447-2";
</script>

<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-52447-2']);
	_gaq.push(['_setDomainName', 'wordpress.com']);
	_gaq.push(['_initData']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		(document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ga);
	})();
</script>
</head>

<body class="single single-post postid-1073 single-format-standard custom-background mp6 customizer-styles-applied has-header-image has-sidebar highlander-enabled highlander-light">

<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	
<div id="hero-header" class="site-hero-section">
	
	<div class="inner">
					<a class="site-logo-link" href="https://woumn.wordpress.com/">
				<img alt="" class="site-logo-image no-grav" width="100" height="100" src="https://secure.gravatar.com/avatar/ab1facf290c91c9d09010e591a167617?s=100&#038;d=identicon&#038;r=g" />
			</a><!-- .site-logo-link -->
				<h1 class="site-title"><a href="https://woumn.wordpress.com/" rel="home">woumn</a></h1>
		<h2 class="site-description">-n. self-defined: the ramblings of a security-minded computer science student.</h2>

			</div><!-- .inner -->
</div><!-- #hero-header -->


	<div id="content-wrapper">
		<header id="masthead" class="site-header" role="banner">
			
			
<div id="secondary" class="widget-area" role="complementary">
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://woumn.wordpress.com/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h1 class="widget-title">Recent Posts</h1>		<ul>
					<li>
				<a href="https://woumn.wordpress.com/2016/10/12/bypassing-aslr-on-windows-into-a-reverse-shell/">Bypassing ASLR on Windows into a Reverse&nbsp;Shell</a>
						</li>
					<li>
				<a href="https://woumn.wordpress.com/2016/10/05/exploring-the-human-interaction-with-science-as-a-primary-nova-in-the-sentinel-by-arthur-c-clark/">Exploring the Human Interaction with Science as a Primary Nova in The Sentinel by Arthur C.&nbsp;Clark</a>
						</li>
					<li>
				<a href="https://woumn.wordpress.com/2016/09/24/smashing-the-stack-into-a-reverse-shell/">Smashing the Stack into a Reverse&nbsp;Shell</a>
						</li>
					<li>
				<a href="https://woumn.wordpress.com/2016/05/02/security-principles-in-ios-architecture/">Security Principles in iOS&nbsp;Architecture</a>
						</li>
					<li>
				<a href="https://woumn.wordpress.com/2016/05/02/gotta-keep-em-separated-with-extra-on-biometrics/">Gotta Keep &#8216;Em Separated with Extra on&nbsp;Biometrics</a>
						</li>
				</ul>
		</aside>		<aside id="archives-2" class="widget widget_archive"><h1 class="widget-title">Archives</h1>		<ul>
			<li><a href='https://woumn.wordpress.com/2016/10/'>October 2016</a></li>
	<li><a href='https://woumn.wordpress.com/2016/09/'>September 2016</a></li>
	<li><a href='https://woumn.wordpress.com/2016/05/'>May 2016</a></li>
		</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h1 class="widget-title">Categories</h1><label class="screen-reader-text" for="cat">Categories</label><select  name='cat' id='cat' class='postform' >
	<option value='-1'>Select Category</option>
	<option class="level-0" value="539908997">K-State CS551&nbsp;&nbsp;(1)</option>
	<option class="level-0" value="254654536">The Secure Enclave&nbsp;&nbsp;(3)</option>
	<option class="level-0" value="1">Uncategorized&nbsp;&nbsp;(2)</option>
</select>

<script type='text/javascript'>
/* <![CDATA[ */
(function() {
	var dropdown = document.getElementById( "cat" );
	function onCatChange() {
		if ( dropdown.options[ dropdown.selectedIndex ].value > 0 ) {
			location.href = "https://woumn.wordpress.com/?cat=" + dropdown.options[ dropdown.selectedIndex ].value;
		}
	}
	dropdown.onchange = onCatChange;
})();
/* ]]> */
</script>

</aside></div><!-- #secondary -->		</header><!-- #masthead -->

		<div id="content" class="site-content">

	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-1073" class="post-1073 post type-post status-publish format-standard hentry category-uncategorized">
			<div class="entry-meta light-text">
			<a href="https://woumn.wordpress.com/author/woumn/" title="Posts by woumn" rel="author">woumn</a>			<span class="cat-links">
				in <a href="https://woumn.wordpress.com/category/uncategorized/" rel="category tag">Uncategorized</a>			</span><!-- .cat-links -->

			<span class="published-on"><time class="entry-date published" datetime="2016-10-12T15:01:12+00:00">October 12, 2016</time><time class="updated" datetime="2016-10-12T22:43:11+00:00">October 12, 2016</time></span>

							<span class="word-count">2,191 Words</span>
			
					</div><!-- .entry-meta -->
			<header class="entry-header">
			<h1 class="entry-title">Bypassing ASLR on Windows into a Reverse&nbsp;Shell</h1>		</header><!-- .entry-header -->
	<div class="entry-content">
		<h1>House Keeping</h1>
<p>I referenced some of my <a href="https://woumn.wordpress.com/2016/09/24/smashing-the-stack-into-a-reverse-shell/">previous exploit</a>&#8216;s work throughout this post, so I&#8217;d suggest you check it out. I&#8217;m also going to mainly focus on the new stack environment we have here, and how to structure a payload to bypass ASLR. This is slightly different than my previous post, and the change is by Alex&#8217;s request. Note: The Windows 7 environment I&#8217;m working on has DEP (Data Execution Prevention) disabled. DEP is just a means to prevent op codes stored on the stack from executing.</p>
<h1>Exploring Windows stack environment</h1>
<p>Compared with Linux, Windows has a slightly different stack layout (why wouldn’t they?).  Apart from a different stack layout, Windows also has different calling conventions. In a bit, I’ll explain what that means for us, but before then understand that on the stack, depending on the environment, either the method that calls another method, or the called method is responsible for cleaning up everything they put on that stack. This is called caller/callee and is important because it adds content to our stack. Back on linux, we operated under the caller paradigm, which means that the method which calls another method pushes the proper instructions onto the stack to be called when the other method returns to clean everything up. However, on windows, we’ll see that this is a callee paradigm, which means the method that is called is responsible for cleaning up the stack. So, still similar to our previous image of a stack in the Linux environment, but modified slightly: <img class=" size-full wp-image-1077 aligncenter" src="https://woumn.files.wordpress.com/2016/10/original_stack.png?w=700" alt="original_stack"   /></p>
<p>We’re left with this image, where EIP is follow by <em>something</em> and then ESP brings up the rear. Well, the something that comes before ESP is in fact the cleanup code that is inserted due to these calling conventions I was talking about. This is important for later because when we’re writing our exploit and we will want to make sure we account for this gap.</p>
<p>And that’s basically it! The Windows stack is surprisingly similar to the Linux stack from our perspective—at least when figuring out how to structure our input. The only other hiccup is that the Windows stack features ASLR, <del>meaning that every new stack frame is placed on a random location on the stack</del> meaning that the location in which the stack <em>starts</em> is random, but each successive stack frame still grows downwards on every function call (and retreats on the function return). Ultimately this is the mechanism we’re attempting to bypass with this exploit, so here lies our challenge.</p>
<p>The original plan is to override EIP with an address to the stack where we placed our shellcode (usually just NOP sleds because we can&#8217;t be super exact). But this poses a problem as soon as stack randomization (ASLR) is applied. Essentially, whenever a new stack frame is allocated, the operating system randomizes the last portion of the address (varies with OS). This means that we can never be <em>sure</em> where our shellcode is on the stack. Well, you&#8217;ll see throughout this blog post that so long as we structure our input correctly, and with just a bit of extra work, we can replace EIP with something different. Instead of the return address to our code, we can put an address that points to the op codes which instruct the computer to jump to ESP. Since ESP is always pointing to the bottom of the current stack frame, it doesn&#8217;t matter where in memory we are, we have a relative address to work with. This is the basis of the exploit, and throughout this blog, you&#8217;ll see how we find this information.</p>
<h2>Structure of the malicious input</h2>
<p>Well, very similarly to the RedHat8 exploit, we will be chiefly concerned with a buffer overflow. The exact length of that buffer will be decided later, but we at least have enough information right now to decide on the actual structure of the buffer.</p>
<p>Let me first address the issue of bypassing ASLR. We use a simple mechanism known as <code>jmp esp</code> which allows us to jump to where ESP is pointing to, regardless of the location. That means we get a relative jump without knowing the specific address ESP is pointing to.  This is a good thing! It means that despite our stack frame being placed randomly on the stack, there will always be a pointer to the end of our stack, and that pointer can be reached with just a simple op code.</p>
<p>Perfect, so as long as we can find the <code>jump esp</code>  instruction, we can just place it into EIP on the stack (remember, whatever EIP points to will be executed). That just leaves the little bit of cleanup code I discussed earlier. Well after speaking with Alex, I don’t know the very fine details of when this code is placed on the stack—all we need to concern ourselves with is just ensuring our payload begins after that code ends. This can be achieved with our good friend the NOP sleds. We’ll just insert a fair amount after we override EIP to make sure that we extend beyond the cleanup code.</p>
<p>The last issue is found again in the encoding of our shellcode. Similar to the RedHat8 exploit, our shellcode will be transmitted, which means we need to encode it. And thus when the shell code is executed, it could potentially expand from the decoding. The solution to this is simply move ESP further up the stack so that any operations our shellcode does, won’t mess up the stack for ESP. Finally, that leaves us with this goal stack in mind:<img class="alignnone size-full wp-image-1102" src="https://woumn.files.wordpress.com/2016/10/goal_stack1.png?w=700" alt="goal_stack"   /></p>
<h2>Determining the parameters used in the malicious input</h2>
<p>For starters, I should note that Windows 7 is in fact, little endian. I only know this by Googling it, but it’s important for how we structure our return addresses, like the <code>jump esp</code> instruction.</p>
<p>The first thing I did was determine our buffer length, or the length that we have to fill before we override EIP. This was done in a very similar fashion to the RedHat8 machine. Namely, we use <code>./pattern_create.rb 5000</code> and send it to our server. I chose 5000 after a simple test of first sending A’s to the server and checking when it finally crashed. There’s really no better way than just guess and check for something like this. Next, we check the debugger and note the part of the pattern that overrode EIP and run it through <code>./pattern_offset.rb PATTERN</code>. This tells us the length of the input which will override EIP, and in our case it is 4093.</p>
<p>Next, we need to find the location in memory, probably in shared library, since those don’t tend to move, that will provide us the <code>jump esp</code> instruction. This is accomplished with Narly, listed above. First, attach to the Apache.exe process and type <code>!load narly</code>. Then <code>!nmod</code> to list all of the packages stores on the stack. We’re chiefly concerned with the packages that are listed without ASLR because we want to ensure it is as static as possible. It should look something like this:<img class=" size-full wp-image-1090 aligncenter" src="https://woumn.files.wordpress.com/2016/10/narly_libs.png?w=700" alt="narly_libs"   /></p>
<p>I chose to search one of the DLLs with the dbg command for search, namely: <code>s 6a6b0000 L?6a6dd000 ff e4</code>. All this does is search through memory starting at the first address, and continue until the second address, and it searches for patterns matching <code>ff e4</code> which is simply the op codes for <code>jump esp</code>. If everything goes right, you’re greeted with a long list of possible addresses, and simply choose one and write it down. Note that this address is not in little endian form, so we do need to change that. Referencing the goal stack, this value is what we’ll override EIP with in an attempt to jump to ESP, a bit further down the stack. I picked the value <code>0x0fbb1477</code>. Which avid readers may recognize as a little endian form, and if you’ve been following along will also realize that this address points to ASLR’d shared libraries. I could never get narly to list things out in non-ASLR memory, which is frustrating and most like the reason why my exploit doesn’t work.</p>
<p>Finally, we need to figure out the op codes to shift ESP, because, remember, otherwise we could corrupt our stack when unpacking or executing the shellcode. We don’t want that to happen. Luckily there is a website called <a href="http://www.defuse.ca"><em>www.defuse.ca</em></a> which has a link to an x86 assembler/disassembler that takes English commands and converts them for you. Simply, we query for <code>add esp, -1000</code>. I  decided on this number mainly because I know our buffer is at least 4000 bytes long, so this will place us somewhere in the second half. Notice that we don&#8217;t need to rearrange these instructions because little endian architecture only applies to addresses, not op codes, and op codes are what we&#8217;re using here.</p>
<p>To address the issue of expanding shellcode, the last value we’re concerned about is the gap between EIP and ESP. This is simply a guessing game. So long as we fill it with innocent instructions, like NOPs, even if we’re off a bit, we can just slide down through to the actual shellcode. I chose a gap of 200 leaving us with this structure.</p>
<p><code>|   fill with length distance_to_eip    | jump esp | gap | add esp |shellcode |</code></p>
<h1>What’s happening?</h1>
<p>As I mentioned above, my exploit does not run local or remotely. I should caveat that because there’s something happening that is difficult to pinpoint and not a result of my exploit rather, most likely the auto-generated shellcode Metasploit spit out.</p>
<p>After trying this exploit for a few hours, I began to notice some irregularities. At the beginning, EIP never got overwritten, eventually, I was able to override it with NOPs, which said to me that something about the structure of my exploit was off. After a bit of tinkering, I decided to fill the 4093 buffer with just addresses to the <code>jump esp</code> instruction. I was using a similar logic to the RedHat8 exploit in that I couldn’t guarantee I could space the buffer perfectly, but I didn’t need to because I could just use the address as filler for the buffer, and so long as it was enough to overrun the buffer and not into ESP, I should be okay.</p>
<p>Now onto the final leg of my journey. After making that change, I tested this again. This time, I was met with something strange—ESP was now pointing to address space that was surrounded with junk, except for the values pointed to by ESP (since they move with ESP when you add to it). In fact, I had to go down 490 bytes in memory to find where my shellcode first began:<img class=" size-full wp-image-1096 aligncenter" src="https://woumn.files.wordpress.com/2016/10/failing_in_shellcode.png?w=700" alt="failing_in_shellcode"   /></p>
<p>Remember I inserted an intentional line of code in front of our payload that would push ESP 1000 bytes further up the stack in an attempt to prevent it from being overwritten when the exploit was executed. Then, I decided I would check and see what EIP was pointing to—what was at <code>0x00d6c732</code>? It turns out this is a memory address that points to a portion in the middle of my shellcode! The exact location is circled in red in the image above.</p>
<p>So out of curiosity, I added the op code for a signal 5, which is a breakpoint, a.k.a. <code>\xcc</code> to the very beginning of my shellcode.  I sent this payload again, and to my surprise, I actually hit the breakpoint, and WINgdb paused, waiting for me to continue execution.<img class=" size-full wp-image-1098 aligncenter" src="https://woumn.files.wordpress.com/2016/10/bp_shellcode.png?w=700" alt="bp_shellcode"   /></p>
<p>Notice EIP is slightly off, but that’s okay because the entire point of this exercise was to bypass ASLR, which meant every time I started the server up, or sent my payload, the stack frame would be placed randomly on the stack. So it’s obviously not going to be the same address as before. But it is still just further down the stack to ESP, which shows that ESP was successfully moved, and we executed at least a few instructions in the shellcode before the exception was thrown.</p>
<h2>Why though?</h2>
<p>Again, I’m really not sure. This was the exact same issue that I had with the RedHat8 machine, which makes me think that there is actually something wrong either with my Kali VM, or with a setting I have in VMWare that is preventing the shellcode of executing, probably due to some error with instancing a socket connection. I tend to believe it’s not my version of Kali because I downloaded a fresh version from the distro website, and there is still no connection between them—the exception is still being thrown.</p>
<p>The difference between this exploit and the RedHat8 exploit is that when I try to run it remotely, this exploit still doesn’t work. I don’t receive any error messages or anything, the connect just hangs with no response—I can only assume that the child process died from the same exception I’m experiencing locally.</p>
		<div class="wpcnt">
			<div class="wpa wpmrec">
				<a class="wpa-about" href="https://wordpress.com/about-these-ads/" rel="nofollow"></a>
				<div class="u">
					<script type='text/javascript'>
					(function(g){g.__ATA.initAd({sectionId:26942, width:300, height:250});})(window);
					</script>
				</div>
			</div>
		</div><div id="jp-post-flair" class="sharedaddy sd-like-enabled sd-sharing-enabled"><div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-1073" class="share-twitter sd-button share-icon" href="https://woumn.wordpress.com/2016/10/12/bypassing-aslr-on-windows-into-a-reverse-shell/?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-1073" class="share-facebook sd-button share-icon" href="https://woumn.wordpress.com/2016/10/12/bypassing-aslr-on-windows-into-a-reverse-shell/?share=facebook" target="_blank" title="Share on Facebook"><span>Facebook</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-1073" class="share-google-plus-1 sd-button share-icon" href="https://woumn.wordpress.com/2016/10/12/bypassing-aslr-on-windows-into-a-reverse-shell/?share=google-plus-1" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-end"></li></ul></div></div></div><div class='sharedaddy sd-block sd-like jetpack-likes-widget-wrapper jetpack-likes-widget-unloaded' id='like-post-wrapper-108864235-1073-57fed94b010e0' data-src='//widgets.wp.com/likes/#blog_id=108864235&amp;post_id=1073&amp;origin=woumn.wordpress.com&amp;obj_id=108864235-1073-57fed94b010e0' data-name='like-post-frame-108864235-1073-57fed94b010e0'><h3 class='sd-title'>Like this:</h3><div class='likes-widget-placeholder post-likes-widget-placeholder' style='height: 55px;'><span class='button'><span>Like</span></span> <span class="loading">Loading...</span></div><span class='sd-text-color'></span><a class='sd-link-color'></a></div></div>	</div><!-- .entry-content -->

	</article><!-- #post-## -->
			
	<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://woumn.wordpress.com/2016/10/05/exploring-the-human-interaction-with-science-as-a-primary-nova-in-the-sentinel-by-arthur-c-clark/" rel="prev">Exploring the Human Interaction with Science as a Primary Nova in The Sentinel by Arthur C.&nbsp;Clark</a></div></div>
	</nav>
			
		
		</main><!-- #main -->
	</div><!-- #primary -->


		</div><!-- #content -->

		<footer id="colophon" class="site-footer" role="contentinfo">
			<div class="site-info">
				<a href="https://wordpress.com/?ref=footer_blog">Blog at WordPress.com.</a>
				
							</div><!-- .site-info -->
		</footer><!-- #colophon -->
	</div><!-- #content-wrapper -->

	</div><!-- #page -->

<!-- wpcom_wp_footer -->
<script type='text/javascript' src='//0.gravatar.com/js/gprofiles.js?ver=201641y'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var WPGroHo = {"my_hash":""};
/* ]]> */
</script>
<script type='text/javascript' src='https://s1.wp.com/wp-content/mu-plugins/gravatar-hovercards/wpgroho.js?m=1380573781h'></script>

	<script>
		//initialize and attach hovercards to all gravatars
		jQuery( document ).ready( function( $ ) {

			if (typeof Gravatar === "undefined"){
				return;
			}

			if ( typeof Gravatar.init !== "function" ) {
				return;
			}			

			Gravatar.profile_cb = function( hash, id ) {
				WPGroHo.syncProfileData( hash, id );
			};
			Gravatar.my_hash = WPGroHo.my_hash;
			Gravatar.init( 'body', '#wp-admin-bar-my-account' );
		});
	</script>

		<div style="display:none">
	</div>

<script type='text/javascript'>/*<![CDATA[*/if(typeof(addLoadEvent)!='undefined'){addLoadEvent(function(){if(top==self){i=document.createElement('img');i.src='https://botd2.wordpress.com/botd.gif?blog=108864235&post=1073&lang=en&date=1476284472&ip=128.138.65.119&url=https://woumn.wordpress.com/2016/10/12/bypassing-aslr-on-windows-into-a-reverse-shell/';i.id='botd2';i.style.width='0px';i.style.height='0px';i.style.overflow='hidden';document.body.appendChild(i);}});}/*]]>*/</script>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/woumn.wordpress.com\/2016\/10\/12\/bypassing-aslr-on-windows-into-a-reverse-shell\/":1073};
	</script>
		<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-twitter' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-facebook' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
		});
		</script>
				<script type="text/javascript">
			var windowOpen;
		jQuery(document).on( 'ready post-load', function(){
			jQuery( 'a.share-google-plus-1' ).on( 'click', function() {
				if ( 'undefined' !== typeof windowOpen ){ // If there's another sharing window open, close it.
					windowOpen.close();
				}
				windowOpen = window.open( jQuery(this).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
		});
		</script>
		<script type='text/javascript'>
/* <![CDATA[ */
var comment_like_text = {"loading":"Loading..."};
/* ]]> */
</script>
<script type='text/javascript'>
/* <![CDATA[ */
var actionbardata = {"siteID":"108864235","siteName":"woumn","siteURL":"http:\/\/woumn.wordpress.com","icon":"<img alt='' src='https:\/\/secure.gravatar.com\/blavatar\/34fad3d3da3acb910577795456af6862?s=36' class='avatar avatar-36' height='36' width='36' \/>","canManageOptions":"","canCustomizeSite":"","isFollowing":"","themeSlug":"pub\/independent-publisher","signupURL":"https:\/\/wordpress.com\/start\/","loginURL":"https:\/\/woumn.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fwoumn.wordpress.com%2F2016%2F10%2F12%2Fbypassing-aslr-on-windows-into-a-reverse-shell%2F","themeURL":"https:\/\/wordpress.com\/themes\/independent-publisher\/","xhrURL":"https:\/\/woumn.wordpress.com\/wp-admin\/admin-ajax.php","nonce":"169482962d","isSingular":"1","isFolded":"","isLoggedIn":"","isMobile":"","subscribeNonce":"<input type=\"hidden\" id=\"_wpnonce\" name=\"_wpnonce\" value=\"9687e978a5\" \/>","referer":"https:\/\/woumn.wordpress.com\/2016\/10\/12\/bypassing-aslr-on-windows-into-a-reverse-shell\/","canFollow":"1","statusMessage":"","customizeLink":"https:\/\/woumn.wordpress.com\/wp-admin\/customize.php?url=https%3A%2F%2Fwoumn.wordpress.com%2F2016%2F10%2F12%2Fbypassing-aslr-on-windows-into-a-reverse-shell%2F","postID":"1073","shortlink":"http:\/\/wp.me\/p7mMyL-hj","canEditPost":"","editLink":"https:\/\/wordpress.com\/post\/woumn.wordpress.com\/1073","i18n":{"view":"View Site","follow":"Follow","following":"Following","edit":"Edit","login":"Log In","signup":"Sign Up","customize":"Customize","report":"Report this content","themeInfo":"Get theme: Independent Publisher","shortlink":"Copy shortlink","copied":"Copied","followedText":"New posts from this site will now appear in your <a href=\"https:\/\/wordpress.com\/\">Reader<\/a>","foldBar":"Collapse this bar","unfoldBar":"Expand this bar","editFollows":"Manage Sites I Follow","editSubs":"Manage Subscriptions","viewReader":"View Site in the Reader","subscribe":"Sign me up","enterEmail":"Enter your email address","followers":"","alreadyUser":"Already have a WordPress.com account? <a href=\"https:\/\/woumn.wordpress.com\/wp-login.php?redirect_to=https%3A%2F%2Fwoumn.wordpress.com%2F2016%2F10%2F12%2Fbypassing-aslr-on-windows-into-a-reverse-shell%2F\">Log in now.<\/a>"}};
/* ]]> */
</script>
<script type='text/javascript'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://s2.wp.com/_static/??-eJydkNFuwjAMRX+IYJAGaA/TviVN3dZt4nhxQvf5S0Fog0mdxksc2/dcJRdmMS5yRs4wKrR4JofyuR11Az9WoRjxpSdW8DShwkfBgoPl1mNaEbsYQh2ZKzQudAM6k+B/oLvBI5gHDFUmpQHiFgXrUbW196QDpsWgK+wyRX4KVk8tGrZn6u1i8pTHRFKfz5PpoitqOvoV8Z82xA7UJZJsZqmRrCRoL79tbPq+raglajadt5RAB5uI+1ut0Ht427+cDsf962m3G78ABVzSmQ=='></script>
<script type="text/javascript">
// <![CDATA[
(function() {
try{
  if ( window.external &&'msIsSiteMode' in window.external) {
    if (window.external.msIsSiteMode()) {
      var jl = document.createElement('script');
      jl.type='text/javascript';
      jl.async=true;
      jl.src='/wp-content/plugins/ie-sitemode/custom-jumplist.php';
      var s = document.getElementsByTagName('script')[0];
      s.parentNode.insertBefore(jl, s);
    }
  }
}catch(e){}
})();
// ]]>
</script>	<script type="text/javascript">
	var skimlinks_pub_id = "725X584219"
	var skimlinks_sitename = "woumn.wordpress.com";
	</script>
	<script type="text/javascript" src="https://s.skimresources.com/js/725X1342.skimlinks.js"></script>		<iframe src='https://widgets.wp.com/likes/master.html?ver=20160429#ver=20160429' scrolling='no' id='likes-master' name='likes-master' style='display:none;'></iframe>
		<div id='likes-other-gravatars'><div class="likes-text"><span>%d</span> bloggers like this:</div><ul class="wpl-avatars sd-like-gravatars"></ul></div>
		<script>
			var _comscore = _comscore || [];
			_comscore.push({
				c1: "2",
				c2: "7518284"
			});
			(function() {
				var s = document.createElement("script"),
					el = document.getElementsByTagName("script")[0];
				s.async = true;
				s.src = (document.location.protocol == "https:" ? "https://sb" : "http://b") + ".scorecardresearch.com/beacon.js";
				el.parentNode.insertBefore(s, el);
			})();
		</script>
		<noscript>
			<p class="robots-nocontent"><img src="https://sb.scorecardresearch.com/p?c1=2&c2=7518284&c3=&c4=&c5=&c6=&c15=&cv=2.0&cj=1" alt="" style="display:none;" width="1" height="1" /></p>
		</noscript><script src="http://stats.wp.com/w.js?54" type="text/javascript" async defer></script>
<script type="text/javascript">
_tkq = window._tkq || [];
_stq = window._stq || [];
_tkq.push(['storeContext', {'blog_id':'108864235','blog_tz':'0','user_lang':'en','blog_lang':'en','user_id':'0'}]);
_stq.push(['view', {'blog':'108864235','v':'wpcom','tz':'0','user_id':'0','post':'1073','subd':'woumn'}]);
_stq.push(['extra', {'crypt':'UE5XaGUuOTlwaD85flAmcm1mcmZsaDhkV11YdWFnNncxc1tjZG9XVXhRREQ/V0xPZ1hKXy8ufDl4UE0uaC5uS2ljaT1kdGxILGdLL1ZwbmhsNEpZeTg5bkpBLz9YSFVwbUNYZkJXYyU/Y1QtJnVfMFhnbytzdltdMjFxbmdNSFlmM0pQdVJiWTVsVVF+V0ktLTBVY0lsV2puMHRvTCZfL0c0R1E4Z0d5bEVOKzJTPVNVYjBCQk94PUlpS2cxRGlyNWoyJWtRenwzVzRTNmtqen5mQz9mXTNnTmVwWFhbTUtrOVoxdkZqS3hsMElUfDcuWGdbZms='}]);
_stq.push([ 'clickTrackerInit', '108864235', '1073' ]);
	</script>
<noscript><img src="https://pixel.wp.com/b.gif?v=noscript" style="height:0px;width:0px;overflow:hidden" alt="" /></noscript>
<script>
if ( 'object' === typeof wpcom_mobile_user_agent_info ) {

	wpcom_mobile_user_agent_info.init();
	var mobileStatsQueryString = "";
	
	if( false !== wpcom_mobile_user_agent_info.matchedPlatformName )
		mobileStatsQueryString += "&x_" + 'mobile_platforms' + '=' + wpcom_mobile_user_agent_info.matchedPlatformName;
	
	if( false !== wpcom_mobile_user_agent_info.matchedUserAgentName )
		mobileStatsQueryString += "&x_" + 'mobile_devices' + '=' + wpcom_mobile_user_agent_info.matchedUserAgentName;
	
	if( wpcom_mobile_user_agent_info.isIPad() )
		mobileStatsQueryString += "&x_" + 'ipad_views' + '=' + 'views';

	if( "" != mobileStatsQueryString ) {
		new Image().src = document.location.protocol + '//pixel.wp.com/g.gif?v=wpcom-no-pv' + mobileStatsQueryString + '&baba=' + Math.random();
	}
	
}
</script>
</body>
</html>